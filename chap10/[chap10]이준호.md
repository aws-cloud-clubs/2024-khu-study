# #10 알림 시스템 설계

**알림 시스템 종류**
- 푸시 알림
- SMS
- 이메일

## 1단계 문제 이해 및 설계 범위 특정

- 어떤 종류의 알림인가?
- 실시간 시스템인가?
- 어떤 종류의 단말을 지원하는가?(IOS, Android, Desktop)
- 알림을 만들 수 있는건 누구인가?
- 사용자가 알림을 받지 않도록 설정할 수 있는가?
- 하루의 몇 건의 알림을 보낼 수 있는가

## 2단계 개략적 설계안 제시 및 동의 구하기

> 알림 유형별 지원 방안

1. ios
알림 제공자 -> APNS -> ios단말

2. 안드로이드 푸시 알림
ios의 APNS 대신 FCM(Firebase Cloud Messaging)사용

3. SMS 메세지
트윌리오, 넥스모와 같은 제3 사업자의 서비스

4. 이메일
고유 이메일 서버 혹은 사용 이메일 서비스 이용

> 연락처 정보 수집 절차

앱 설치/계정 등록시 API 서버가 사용자 정보를 수집하여 DB에 저장

> 알림 전송 및 수신 절차

**주의할 사항과 해결책**
- SPOF -> DB와 캐시를 알림 시스템의 주 서버와 분리
- 규모확장성 -> 알림 서버 증설 및 자동으로 수평적 규모 확장이 되도록 하기
- 성능 병목 -> 메세지 큐를 이용




## 3단계 상세 설계

> 안정성

- 데이터 손실 방지(재시도 or 알람 로그 DB)
- 알림 중복 전송 방지(이벤트 ID 검사) - 100%방지는 불가능

> 추가로 필요한 컴포넌트 및 고려사항

- 알림 템플릿
- 알림 설정
- 전송률 제한
- 재시도 방법
- 푸시 알림과 보안
- 큐 모니터링(너무 쌓여있다? -> 서버 증설 필요)
- 이벤트 추적

![](https://lh6.googleusercontent.com/_oBl6bPE50_pgFpxIG3Ru0PAVeX8bhREmslEPC8MPcmnBDwoUVGd748WgCk9TThFIZLgrVtBtsxDTZd19rzgPYbHO1HzYp00HGm_LNJw1Ip1Jgv6CZo5yjbvNAG2z2yAA7fkOWp1NPKGG732PL383W8)



## 4단계 마무리

 알림은 필수불가결한 기능!

 **집중한 부분**
 - 안정성
 - 보인
 - 이벤트 추적 및 모니터링
 - 사용자 설정
 - 전송률 제한

